{% extends "base.html" %}
{% block content %}
  <section class="card matches-card">
    <div class="match-meta">
      <p class="eyebrow">GSPro League Matches</p>
      <h1 class="match-title">All Scheduled Matches</h1>
      <p class="match-sub">Every pairing is listed with current status, hole count, and result details.</p>
      <form class="match-list-filter" method="get">
        <label for="match-player-filter">
          <span class="muted-label">Show only</span>
          <select id="match-player-filter" name="player" onchange="this.form.submit()">
            <option value="all" {% if active_player == "all" or not active_player %}selected{% endif %}>All players</option>
            {% for player in players %}
              <option value="{{ player }}" {% if active_player == player %}selected{% endif %}>{{ player }}</option>
            {% endfor %}
          </select>
        </label>
      </form>
    </div>

    {% if matches %}
      <div class="match-list-table-wrapper">
        <table class="match-list-table">
          <thead>
            <tr>
              <th scope="col">Match</th>
              <th scope="col">Status</th>
              <th scope="col">Totals</th>
              <th scope="col">Winner</th>
              <th scope="col">Holes</th>
              <th scope="col">Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for match in matches %}
              <tr>
                <td>
                  <p class="match-name">{{ match.display }}</p>
                  <p class="match-list-card__meta">{{ match.player_a }} vs {{ match.player_b }}</p>
                  {% if match.submitted %}
                    <p class="match-list-card__submitted">Submitted {{ match.submitted }}</p>
                  {% endif %}
                </td>
                <td>
                  <span class="status-pill status-pill--{{ match.status }}">
                    {{ match.status_label }}
                  </span>
                </td>
                <td>
                  <strong>{{ match.totals }}</strong>
                </td>
                <td>
                  <strong>{{ match.winner }}</strong>
                </td>
                <td>
                  <strong>{{ match.holes }}</strong>
                </td>
                <td class="match-list-table__actions">
                  <a class="pill-link" href="/scorecard?match_key={{ match.match_key }}">View scorecard</a>
                  {% if match.result_id %}
                    <a class="pill-link" href="/matches/{{ match.result_id }}">Match detail</a>
                  {% else %}
                    <span class="pill-link pill-link--disabled" aria-disabled="true">Match detail pending</span>
                  {% endif %}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p class="status">No matches defined yet.</p>
    {% endif %}
  </section>
{% endblock %}
